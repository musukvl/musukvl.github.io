"use strict";function Logger(){var a=this;a.enabled=!1,a.write=function(b,c){a.enabled&&("string"!=typeof c&&(c=JSON.stringify(c)),console.log(b+": "+c))},a.log=function(b,c){a.write(b,c)},a.debug=function(b){a.write("debug",b)},a.info=function(b){a.write("info",b)},a.error=function(b){a.write("error",b)}}var log=new Logger;!function(a){a.fn.drags=function(b){if(b=a.extend({handle:""},b),""===b.handle)var c=this;else var c=this.find(b.handle);return c.on("mousedown",function(c){if(""===b.handle)var d=a(this).addClass("draggable");else var d=a(this).addClass("active-handle").parent().addClass("draggable");var e=d.css("z-index"),f=d.outerHeight(),g=d.outerWidth(),h=d.offset().top+f-c.pageY,i=d.offset().left+g-c.pageX;d.css("z-index",1e3).parents().on("mousemove",function(b){a(".draggable").offset({top:b.pageY+h-f,left:b.pageX+i-g}).on("mouseup",function(){a(this).removeClass("draggable").css("z-index",e)})}),c.preventDefault()}).on("mouseup",function(){""===b.handle?a(this).removeClass("draggable"):a(this).removeClass("active-handle").parent().removeClass("draggable")})}}(jQuery),function(a){function b(){l.show(),o.show()}function c(){l.hide(),o.hide()}function d(){var a=l.outerHeight(),b=l.outerWidth(),c=Math.max(0,(k.height()-a)/2),d=Math.max(0,(k.width()-b)/2);l.css({top:c,left:d})}function e(){if(!l.length){o=a('<div id="scroll-view-overlay"></div>');var b=a('<div id="scroll-view-box"><img id="scroll-view-image" src=""/><div id="scroll-view-image-title"></div><div id="scroll-view-close-button"><span>Ã—</span></div><div id="scroll-view-next-button"></div><div id="scroll-view-prev-button"></div></div>');b.hide(),o.hide(),a("body").append(o),a("body").append(b),l=a("#scroll-view-box"),m=a("#scroll-view-image"),n=a("#scroll-view-image-title"),p=a("#scroll-view-close-button"),q=a("#scroll-view-next-button"),r=a("#scroll-view-prev-button"),l.drags(),o.click(function(){c()}),p.click(function(){c()}),l.mousewheel(function(a){f(a.deltaY<0?-1:1,a.clientX,a.clientY),a.preventDefault()})}}function f(a,b,c){var d=b-(l.offset().left-k.scrollLeft()),e=c-(l.offset().top-k.scrollTop()),f=.05*a,g=l.width(),h=(l.outerWidth()-l.width())/2,i=(l.outerHeight()-l.height())/2,j=g+g*f,m=(d-h)*f,n=(e-i)*f,o=l.offset().top,p=l.offset().left;l.width(j),l.css({top:o-n-k.scrollTop(),left:p-m-k.scrollLeft()})}function g(){log.write("adjustBoxSizeForImage",{for_src:m[0].src});var b=m[0].naturalWidth,c=m[0].naturalHeight;log.info({imgWidth:b,imgHeight:c}),(0==b||0==c)&&(b=128,c=128);var d=l.outerWidth()-l.width(),e=l.outerHeight()-l.height(),f=n.outerHeight(),g=40,h=a(window).width()-d-2*g,i=a(window).height()-e-f-60,j=h/b,k=i/c;l.width(j>1&&k>1?b:1>j||1>k?j>k?b*k:b*j:500)}function h(){g(),d(),b()}function i(a){return a.complete||"complete"==a.readyState||4==a.readyState}function j(b,c){return log.write("start waiting",{src:b.src}),i(b)?(log.write("image already loaded",{src:b.src}),void c(b)):void a(b).one("load",c).each(function(){log.write("image load fired",{src:b.src}),i(b)&&(log.write("image just loaded",{src:b.src}),c(b))})}var k=a(window),l=a("#scroll-view-box"),m=a("#scroll-view-image"),n=a("#scroll-view-image-title"),o=a("#scroll-view-overlay"),p=a("#scroll-view-close-button"),q=a("#scroll-view-next-button"),r=a("#scroll-view-prev-button");a(document).keyup(function(a){13==a.keyCode,27==a.keyCode&&c()}),a.ambaImageViewer=function(b,d){function f(){var a=o.$img.attr("alt");a?(n.html(a),n.show()):n.hide(),g(),h()}function g(){d.group?(q.show(),r.show(),q.unbind("click"),q.click(l),r.unbind("click"),r.click(k)):(q.hide(),r.hide())}function k(){o.prev()}function l(){o.next()}var o=this;o.$el=a(b),o.el=b,o.$img=o.$el.find("img"),o.init=function(){o.options=a.extend({},a.ambaImageViewer.defaultOptions,d),o.imageSrc=o.$el.attr("href"),e(),o.$el.click(function(a){a.preventDefault(),o.open()})},o.next=function(){if(d.group){var a=d.groupIndex+1==d.group.length?0:d.groupIndex+1,b=d.group[a];b.ambaImageViewer("open")}},o.prev=function(){if(d.group){var a=0==d.groupIndex?d.group.length-1:d.groupIndex-1,b=d.group[a];b.ambaImageViewer("open")}},o.hide=function(){c()},o.open=function(){var a=new Image;a.src=o.imageSrc,!i(a)&&o.options.loaderImage&&(log.write("show loader",{for_src:a.src}),m.attr("src",""),m.attr("src",o.options.loaderImage),f()),j(a,function(){m.attr("src",a.src),f()})},o.init()},a.ambaImageViewer.defaultOptions={loaderImage:"img/loader.gif"},a.fn.ambaImageViewer=function(b){if("string"==typeof b)return void this.each(function(){a(this).data("ambaImageViewer")[b]()});b||(b={});var c={};return this.each(function(d,e){var f=a(e),g=f.attr("data-group"),h=a.extend({},b);g&&(c[g]||(c[g]=[]),c[g].push(f),h.group=c[g],h.groupIndex=c[g].length-1);var i=new a.ambaImageViewer(e,h);f.data("ambaImageViewer",i)})}}(jQuery);
//# sourceMappingURL=amba.imageviewer.min.js.map